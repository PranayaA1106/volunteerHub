<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discover Your Cause — VolunteerHub</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
    --teal-deep:   #2d6a75;
    --teal-mid:    #4e9aa6;
    --teal-soft:   #b8dde3;
    --teal-pale:   #e8f5f7;
    --blush:       #f9d4bc;
    --blush-pale:  #fef6f0;
    --orange-mid:  #f0a070;
    --orange-deep: #d4743a;
    --orange-pale: #fef6f0;
    --cream:       #faf8f5;
    --ink:         #1c2b2e;
    --ink-mid:     #3d5457;
    --ink-light:   #7a9498;
    --white:       #ffffff;
    --border:      #ddeaec;
    --sidebar-w:   260px;
}

html { scroll-behavior: smooth; }

body {
    font-family: 'DM Sans', sans-serif;
    background: var(--cream);
    color: var(--ink);
    min-height: 100vh;
    display: flex;
}

/* ─── SIDEBAR ─────────────────────────────────────── */
.sidebar {
    width: var(--sidebar-w);
    min-height: 100vh;
    background: linear-gradient(160deg, var(--teal-deep) 0%, var(--teal-mid) 100%);
    border-radius: 0 36px 36px 0;
    padding: 36px 24px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    position: sticky;
    top: 0;
    height: 100vh;
    box-shadow: 6px 0 40px rgba(45,106,117,0.18);
    z-index: 10;
    flex-shrink: 0;
}

.logo img {
    width: 160px;
    height: auto;
    margin-bottom: 48px;
    display: block;
}

.nav-links { display: flex; flex-direction: column; gap: 6px; }

.nav-links a {
    color: rgba(255,255,255,0.75);
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 13px 16px;
    border-radius: 16px;
    font-size: 14px;
    font-weight: 500;
    letter-spacing: 0.2px;
    transition: all 0.25s ease;
}
.nav-links a svg { width: 17px; height: 17px; flex-shrink: 0; }
.nav-links a:hover {
    background: rgba(255,255,255,0.12);
    color: white;
    transform: translateX(4px);
}
.nav-links a.active {
    background: white;
    color: var(--teal-deep);
    font-weight: 600;
    box-shadow: 0 6px 20px rgba(0,0,0,0.12);
}

.sidebar-footer {
    border-top: 1px solid rgba(255,255,255,0.15);
    padding-top: 20px;
}

.logout-btn {
    width: 100%;
    padding: 13px;
    background: rgba(255,255,255,0.12);
    color: white;
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 16px;
    font-size: 14px;
    font-weight: 500;
    font-family: 'DM Sans', sans-serif;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.25s;
}
.logout-btn svg { width: 16px; height: 16px; }
.logout-btn:hover {
    background: rgba(255,255,255,0.22);
    transform: translateY(-1px);
}

/* ─── MAIN ────────────────────────────────────────── */
.main-content {
    flex: 1;
    padding: 40px 48px;
    overflow-y: auto;
    min-height: 100vh;
}

/* ─── PAGE HEADER ─────────────────────────────────── */
.page-header {
    margin-bottom: 36px;
    text-align: center;
}

.page-header .eyebrow {
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 2.5px;
    text-transform: uppercase;
    color: var(--orange-mid);
    margin-bottom: 10px;
}

.page-header h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 54px;
    font-weight: 600;
    color: var(--ink);
    line-height: 1.1;
}

.page-header h1 em {
    font-style: italic;
    color: var(--orange-mid);
}

/* ─── PROGRESS BAR ────────────────────────────────── */
.progress-bar-wrap {
    background: var(--border);
    border-radius: 99px;
    height: 6px;
    margin: 0 auto 36px auto;
    max-width: 860px;
    overflow: hidden;
}
.progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--orange-mid), var(--teal-mid));
    border-radius: 99px;
    transition: width 0.6s cubic-bezier(0.22,1,0.36,1);
    width: 0%;
}

/* ─── QUESTION CARD ───────────────────────────────── */
.question-card {
    background: white;
    border-radius: 32px;
    padding: 52px 56px;
    max-width: 860px;
    margin: 0 auto 20px auto;
    box-shadow: 0 4px 32px rgba(45,106,117,0.07);
    border: 1px solid var(--border);
    display: none;
    animation: slideIn 0.4s cubic-bezier(0.22,1,0.36,1);
}
.question-card.active { display: block; }

@keyframes slideIn {
    from { opacity: 0; transform: translateY(18px); }
    to   { opacity: 1; transform: translateY(0); }
}

.q-meta {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 24px;
}
.q-number {
    width: 38px;
    height: 38px;
    background: linear-gradient(135deg, var(--orange-deep), var(--orange-mid));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    font-weight: 700;
    color: white;
    flex-shrink: 0;
}
.q-label {
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--ink-light);
}

.question-card h2 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 36px;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 28px;
    line-height: 1.25;
}

/* ─── OPTIONS GRID ────────────────────────────────── */
.options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
}

.option-btn {
    background: var(--teal-pale);
    border: 2px solid transparent;
    border-radius: 20px;
    padding: 22px 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 16px;
    text-align: left;
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    font-weight: 500;
    color: var(--ink-mid);
    transition: all 0.22s ease;
    position: relative;
    overflow: hidden;
}

.option-btn .opt-icon {
    width: 46px;
    height: 46px;
    background: white;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: var(--teal-mid);
    box-shadow: 0 2px 8px rgba(78,154,166,0.15);
    position: relative;
    z-index: 1;
    transition: all 0.22s;
}
.option-btn .opt-icon svg { width: 20px; height: 20px; }
.option-btn span { position: relative; z-index: 1; line-height: 1.4; }

.option-btn:hover {
    border-color: var(--orange-mid);
    background: var(--orange-pale);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(232,128,74,0.15);
}
.option-btn:hover .opt-icon {
    background: white;
    color: var(--orange-mid);
}

.option-btn.selected {
    border-color: var(--orange-mid);
    background: linear-gradient(135deg, var(--teal-pale), var(--orange-pale));
    box-shadow: 0 8px 28px rgba(232,128,74,0.18);
}
.option-btn.selected .opt-icon {
    background: linear-gradient(135deg, var(--teal-mid), var(--orange-mid));
    color: white;
    box-shadow: 0 4px 14px rgba(232,128,74,0.35);
}
.option-btn.selected span:last-child {
    color: var(--ink);
    font-weight: 600;
}

/* ─── NAV BUTTONS ─────────────────────────────────── */
.card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 32px;
    max-width: 860px;
    margin-left: auto;
    margin-right: auto;
}

.btn-next, .btn-prev, .btn-submit {
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    font-weight: 600;
    border: none;
    cursor: pointer;
    border-radius: 16px;
    padding: 16px 32px;
    transition: all 0.25s;
    display: flex;
    align-items: center;
    gap: 10px;
}
.btn-next svg, .btn-submit svg, .btn-prev svg { width: 18px; height: 18px; }

.btn-next, .btn-submit {
    background: linear-gradient(135deg, var(--teal-mid), var(--orange-mid));
    color: white;
}
.btn-next:hover, .btn-submit:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 28px rgba(45,106,117,0.3);
}
.btn-next:disabled, .btn-submit:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.btn-prev {
    background: transparent;
    color: var(--ink-light);
    border: 1.5px solid var(--border);
}
.btn-prev:hover { border-color: var(--teal-mid); color: var(--teal-mid); }
.btn-prev:disabled { opacity: 0.3; cursor: not-allowed; }

/* ─── RESULTS ─────────────────────────────────────── */
#resultsSection {
    animation: slideIn 0.5s cubic-bezier(0.22,1,0.36,1);
    max-width: 860px;
    margin: 0 auto;
}

.results-hero {
    background: linear-gradient(135deg, var(--teal-deep) 0%, var(--teal-mid) 45%, var(--orange-mid) 100%);
    border-radius: 32px;
    padding: 52px 52px 48px;
    color: white;
    margin-bottom: 28px;
    position: relative;
    overflow: hidden;
}
.results-hero::before {
    content: '';
    position: absolute;
    width: 320px; height: 320px;
    background: rgba(255,255,255,0.06);
    border-radius: 50%;
    top: -80px; right: -60px;
}
.results-hero::after {
    content: '';
    position: absolute;
    width: 200px; height: 200px;
    background: rgba(255,255,255,0.04);
    border-radius: 50%;
    bottom: -60px; left: 40px;
}
.results-hero .hero-content { position: relative; z-index: 1; }

.results-eyebrow {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: rgba(255,255,255,0.85);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
}
.results-eyebrow svg { width: 14px; height: 14px; }

.results-hero h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 58px;
    font-weight: 600;
    line-height: 1.1;
    margin-bottom: 16px;
}

.results-hero p {
    font-size: 17px;
    line-height: 1.7;
    color: rgba(255,255,255,0.85);
    max-width: 520px;
}

/* ─── RESULT BOTTOM GRID ──────────────────────────── */
.result-bottom {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 24px;
}

.result-card {
    background: white;
    border-radius: 24px;
    padding: 30px;
    border: 1px solid var(--border);
    box-shadow: 0 4px 24px rgba(45,106,117,0.06);
}

.card-label {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--ink-light);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
}
.card-label svg { width: 14px; height: 14px; color: var(--orange-mid); }

.skill-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
.skill-pill {
    padding: 9px 18px;
    border-radius: 99px;
    font-size: 14px;
    font-weight: 500;
    background: var(--orange-pale);
    color: var(--orange-deep);
    border: 1.5px solid var(--blush);
    transition: all 0.2s;
}
.skill-pill:hover {
    background: var(--blush);
    transform: scale(1.04);
}

.trait-grid { display: grid; gap: 10px; }
.trait-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 15px;
    color: var(--ink-mid);
}
.trait-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--orange-mid), var(--teal-mid));
    flex-shrink: 0;
}

/* ─── CTA ─────────────────────────────────────────── */
.cta-row {
    display: flex;
    gap: 14px;
    flex-wrap: wrap;
}

.btn-cta {
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    font-weight: 600;
    padding: 16px 32px;
    border-radius: 16px;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.25s;
}
.btn-cta svg { width: 17px; height: 17px; }
.btn-cta.primary {
    background: linear-gradient(135deg, var(--teal-mid), var(--orange-mid));
    color: white;
}
.btn-cta.primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 30px rgba(45,106,117,0.28);
}
.btn-cta.ghost {
    background: white;
    color: var(--ink-mid);
    border: 1.5px solid var(--border);
}
.btn-cta.ghost:hover {
    border-color: var(--teal-mid);
    color: var(--teal-mid);
}

/* ─── RESPONSIVE ──────────────────────────────────── */
@media (max-width: 900px) {
    .options-grid { grid-template-columns: 1fr; }
    .result-bottom { grid-template-columns: 1fr; }
    .main-content { padding: 28px 24px; }
    .results-hero { padding: 36px 28px; }
    .results-hero h1 { font-size: 36px; }
}

@media (max-width: 680px) {
    body { flex-direction: column; }
    .sidebar {
        width: 100%;
        min-height: unset;
        height: auto;
        border-radius: 0 0 28px 28px;
        padding: 20px 24px;
        position: relative;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 12px;
    }
    .logo img { width: 120px; margin-bottom: 0; }
    .nav-links { flex-direction: row; flex-wrap: wrap; gap: 6px; }
    .nav-links a { padding: 9px 14px; font-size: 13px; }
    .nav-links a:hover { transform: none; }
    .sidebar-footer { border-top: none; padding-top: 0; }
    .main-content { padding: 24px 16px; }
    .page-header h1 { font-size: 32px; }
    .question-card { padding: 32px 28px; }
    .question-card h2 { font-size: 26px; }
    .card-footer { flex-direction: column-reverse; gap: 10px; }
    .btn-next, .btn-prev, .btn-submit { width: 100%; justify-content: center; }
}
</style>
</head>
<body>

<!-- SIDEBAR -->
<aside class="sidebar">
    <div>
        <div class="logo">
            <img src="images/volunteerhub-logo.png" alt="VolunteerHub">
        </div>
        <nav class="nav-links">
            <a href="dashboard.html"><i data-lucide="bar-chart-3"></i> Dashboard</a>
            <a href="volunteer.html"><i data-lucide="briefcase"></i> Opportunities</a>
            <a href="quiz.html" class="active"><i data-lucide="sparkles"></i> Quiz</a>
            <a href="map.html"><i data-lucide="map"></i> Map</a>
            <a href="calendar.html"><i data-lucide="calendar"></i> Calendar</a>
        </nav>
    </div>
    <div class="sidebar-footer">
        <button onclick="logout()" class="logout-btn">
            <i data-lucide="log-out"></i> Logout
        </button>
    </div>
</aside>

<!-- MAIN -->
<main class="main-content">

    <!-- QUIZ -->
    <div id="quizSection">
        <div class="page-header">
            <p class="eyebrow">Volunteer Quiz</p>
            <h1>Discover Your <em>Perfect Cause</em></h1>
        </div>

        <div class="progress-bar-wrap">
            <div class="progress-bar-fill" id="progressFill"></div>
        </div>

        <!-- Q1 -->
        <div class="question-card active" id="q1-card">
            <div class="q-meta">
                <div class="q-number">1</div>
                <span class="q-label">Question 1 of 4</span>
            </div>
            <h2>What excites you most?</h2>
            <div class="options-grid" data-q="q1">
                <button class="option-btn" data-value="people">
                    <span class="opt-icon"><i data-lucide="users"></i></span>
                    <span>Working with people &amp; communities</span>
                </button>
                <button class="option-btn" data-value="tech">
                    <span class="opt-icon"><i data-lucide="cpu"></i></span>
                    <span>Technology &amp; innovation</span>
                </button>
                <button class="option-btn" data-value="environment">
                    <span class="opt-icon"><i data-lucide="leaf"></i></span>
                    <span>Nature &amp; environment</span>
                </button>
                <button class="option-btn" data-value="animals">
                    <span class="opt-icon"><i data-lucide="paw-print"></i></span>
                    <span>Animals &amp; wildlife</span>
                </button>
            </div>
        </div>

        <!-- Q2 -->
        <div class="question-card" id="q2-card">
            <div class="q-meta">
                <div class="q-number">2</div>
                <span class="q-label">Question 2 of 4</span>
            </div>
            <h2>How much time can you commit?</h2>
            <div class="options-grid" data-q="q2">
                <button class="option-btn" data-value="one-time">
                    <span class="opt-icon"><i data-lucide="zap"></i></span>
                    <span>One-time events only</span>
                </button>
                <button class="option-btn" data-value="short">
                    <span class="opt-icon"><i data-lucide="clock"></i></span>
                    <span>Short tasks (30–60 min)</span>
                </button>
                <button class="option-btn" data-value="regular">
                    <span class="opt-icon"><i data-lucide="calendar"></i></span>
                    <span>Regular commitment (weekly/monthly)</span>
                </button>
                <button class="option-btn" data-value="flexible">
                    <span class="opt-icon"><i data-lucide="refresh-cw"></i></span>
                    <span>Flexible, as needed</span>
                </button>
            </div>
        </div>

        <!-- Q3 -->
        <div class="question-card" id="q3-card">
            <div class="q-meta">
                <div class="q-number">3</div>
                <span class="q-label">Question 3 of 4</span>
            </div>
            <h2>What type of work appeals to you?</h2>
            <div class="options-grid" data-q="q3">
                <button class="option-btn" data-value="teaching">
                    <span class="opt-icon"><i data-lucide="book-open"></i></span>
                    <span>Teaching &amp; mentoring</span>
                </button>
                <button class="option-btn" data-value="design">
                    <span class="opt-icon"><i data-lucide="palette"></i></span>
                    <span>Creative &amp; design work</span>
                </button>
                <button class="option-btn" data-value="medical">
                    <span class="opt-icon"><i data-lucide="stethoscope"></i></span>
                    <span>Healthcare &amp; medical support</span>
                </button>
                <button class="option-btn" data-value="hands-on">
                    <span class="opt-icon"><i data-lucide="hammer"></i></span>
                    <span>Hands-on physical work</span>
                </button>
            </div>
        </div>

        <!-- Q4 -->
        <div class="question-card" id="q4-card">
            <div class="q-meta">
                <div class="q-number">4</div>
                <span class="q-label">Question 4 of 4</span>
            </div>
            <h2>Who do you most want to help?</h2>
            <div class="options-grid" data-q="q4">
                <button class="option-btn" data-value="children">
                    <span class="opt-icon"><i data-lucide="baby"></i></span>
                    <span>Children &amp; youth</span>
                </button>
                <button class="option-btn" data-value="elderly">
                    <span class="opt-icon"><i data-lucide="user"></i></span>
                    <span>Elderly &amp; seniors</span>
                </button>
                <button class="option-btn" data-value="poverty">
                    <span class="opt-icon"><i data-lucide="hand-heart"></i></span>
                    <span>People in poverty</span>
                </button>
                <button class="option-btn" data-value="everyone">
                    <span class="opt-icon"><i data-lucide="globe"></i></span>
                    <span>Everyone equally</span>
                </button>
            </div>
        </div>

        <!-- FOOTER BUTTONS -->
        <div class="card-footer">
            <button class="btn-prev" id="prevBtn" disabled>
                <i data-lucide="arrow-left"></i> Back
            </button>
            <button class="btn-next" id="nextBtn" disabled>
                Next <i data-lucide="arrow-right"></i>
            </button>
            <button class="btn-next btn-submit" id="submitBtn" style="display:none;" disabled>
                See My Cause <i data-lucide="arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- RESULTS -->
    <div id="resultsSection" style="display:none;">

        <div class="results-hero">
            <div class="hero-content">
                <div class="results-eyebrow">
                    <i data-lucide="sparkles"></i>
                    Your perfect match
                </div>
                <h1 id="resultCause">Loading…</h1>
                <p id="resultDescription"></p>
            </div>
        </div>

        <div class="result-bottom">
            <div class="result-card">
                <div class="card-label">
                    <i data-lucide="sparkles"></i>
                    Skills to develop
                </div>
                <div class="skill-pills" id="suggestedSkills"></div>
            </div>
            <div class="result-card">
                <div class="card-label">
                    <i data-lucide="heart"></i>
                    Why this suits you
                </div>
                <div class="trait-grid" id="traitList"></div>
            </div>
        </div>

        <div class="cta-row">
            <button class="btn-cta primary" onclick="window.location.href='volunteer.html'">
                <i data-lucide="briefcase"></i>
                Browse Opportunities
            </button>
            <button class="btn-cta ghost" onclick="retakeQuiz()">
                <i data-lucide="refresh-cw"></i>
                Retake Quiz
            </button>
        </div>

    </div>

</main>

<script>
lucide.createIcons();
</script>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
import { getFirestore, doc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

const firebaseConfig = {
    apiKey: "AIzaSyDdTtQm8uDTDrWjgfsTHG5zTIkxhDi1mu8",
    authDomain: "volunteerhub-5c419.firebaseapp.com",
    projectId: "volunteerhub-5c419",
    storageBucket: "volunteerhub-5c419.firebasestorage.app",
    messagingSenderId: "769987727654",
    appId: "1:769987727654:web:20f964e64bcae74d8bb1e7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
let currentUser = null;

onAuthStateChanged(auth, (user) => {
    if (user) { currentUser = user; }
    else { window.location.href = 'index.html'; }
});

window.logout = async () => {
    await signOut(auth);
    window.location.href = 'index.html';
};

// ─── State
const TOTAL = 4;
let current = 1;
const answers = {};

const prevBtn   = document.getElementById('prevBtn');
const nextBtn   = document.getElementById('nextBtn');
const submitBtn = document.getElementById('submitBtn');
const fill      = document.getElementById('progressFill');

function updateUI() {
    document.querySelectorAll('.question-card').forEach((c, i) =>
        c.classList.toggle('active', i + 1 === current)
    );
    prevBtn.disabled        = current === 1;
    const hasAnswer         = !!answers[`q${current}`];
    const isLast            = current === TOTAL;
    nextBtn.style.display   = isLast ? 'none' : 'flex';
    submitBtn.style.display = isLast ? 'flex' : 'none';
    nextBtn.disabled        = !hasAnswer;
    submitBtn.disabled      = !hasAnswer;
    fill.style.width        = `${((current - 1) / TOTAL) * 100}%`;
}

document.querySelectorAll('.options-grid').forEach(grid => {
    grid.querySelectorAll('.option-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            grid.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            answers[grid.dataset.q] = btn.dataset.value;
            updateUI();
        });
    });
});

prevBtn.addEventListener('click', () => { if (current > 1) { current--; updateUI(); } });
nextBtn.addEventListener('click', () => { if (current < TOTAL && answers[`q${current}`]) { current++; updateUI(); } });

// ─── Cause data
const causeMap = {
    'people-teaching-children': {
        cause: 'Education for Children',
        description: 'You have a natural gift for nurturing young minds. Your passion for people and teaching makes you perfectly suited for child literacy and learning programs.',
        skills: ['Teaching', 'Curriculum Design', 'Child Psychology', 'Creative Writing'],
        traits: ['You connect deeply with people', 'You love sharing knowledge', 'Children inspire you']
    },
    'people-teaching-elderly': {
        cause: 'Adult Education & Senior Support',
        description: 'You believe in lifelong learning and the dignity of every person. NGOs supporting elderly education and companionship would thrive with your warmth.',
        skills: ['Teaching', 'Empathy', 'Communication', 'Elder Care'],
        traits: ["You're patient and kind", 'You value wisdom in others', 'Community matters to you']
    },
    'people-teaching-poverty': {
        cause: 'Education for the Underprivileged',
        description: 'You want to break cycles of poverty through knowledge. Your blend of people skills and teaching passion is a powerful force for equity.',
        skills: ['Teaching', 'Fundraising', 'Community Outreach', 'Marketing'],
        traits: ['You believe in equity', "You're driven by purpose", 'You inspire change']
    },
    'tech-design-everyone': {
        cause: 'Technology for Social Good',
        description: 'You see technology as a tool for transformation. Organisations building digital solutions for real-world problems need your creative and technical vision.',
        skills: ['UX Design', 'Web Development', 'Data Analysis', 'Digital Marketing'],
        traits: ['You love solving problems', 'You think innovatively', 'You build for impact']
    },
    'environment-hands-on-everyone': {
        cause: 'Environmental Conservation',
        description: "You're driven to protect the planet with your hands and heart. Conservation projects need grounded, passionate volunteers who show up and do the work.",
        skills: ['Conservation', 'Environmental Science', 'Fundraising', 'Advocacy'],
        traits: ['You love the outdoors', 'You act, not just talk', 'You think long-term']
    },
    'animals-hands-on-everyone': {
        cause: 'Animal Welfare',
        description: 'Your compassion extends to every living creature. Animal rescue and welfare organisations need dedicated people like you for hands-on care and advocacy.',
        skills: ['Animal Care', 'Veterinary Support', 'Fundraising', 'Social Media'],
        traits: ['You feel deeply for animals', "You're nurturing by nature", 'You advocate for the voiceless']
    },
    'medical-children': {
        cause: 'Child Health & Nutrition',
        description: 'You care about children thriving, not just surviving. Health-focused NGOs working with children need medical and support volunteers with your warmth.',
        skills: ['Healthcare', 'Nutrition', 'Child Development', 'Fundraising'],
        traits: ['You put children first', 'You have a caring instinct', "You're motivated by wellbeing"]
    },
    'medical-elderly': {
        cause: 'Elderly Healthcare',
        description: 'You bring both skill and dignity to elder care. Organisations supporting senior health and wellbeing would be transformed by your presence.',
        skills: ['Healthcare', 'Elder Care', 'Palliative Support', 'Community Outreach'],
        traits: ['You honour your elders', "You're calm under pressure", 'You give without expectation']
    },
    'poverty-everyone': {
        cause: 'Poverty Alleviation',
        description: 'You want everyone to have what they need to live well. Poverty relief NGOs need compassionate volunteers for fundraising, outreach, and community support.',
        skills: ['Fundraising', 'Community Building', 'Logistics', 'Advocacy'],
        traits: ['You believe in equality', "You're generous at heart", 'You build bridges']
    },
    'default': {
        cause: 'Community Service',
        description: "You're a versatile force for good. Your broad compassion makes you a perfect fit for multi-cause NGOs that need all-round support and energy.",
        skills: ['Communication', 'Event Planning', 'Fundraising', 'Social Media'],
        traits: ['You adapt easily', 'You care about everyone', 'You show up where needed']
    }
};

submitBtn.addEventListener('click', async () => {
    const { q1, q2, q3, q4 } = answers;
    if (!q1 || !q2 || !q3 || !q4) return;

    let key = 'default';
    if (q1 === 'people' && q3 === 'teaching')           key = `people-teaching-${q4}`;
    else if (q1 === 'tech'  && q3 === 'design')         key = 'tech-design-everyone';
    else if (q1 === 'environment' && q3 === 'hands-on') key = 'environment-hands-on-everyone';
    else if (q1 === 'animals')                          key = 'animals-hands-on-everyone';
    else if (q3 === 'medical')                          key = `medical-${q4}`;
    else if (q4 === 'poverty')                          key = 'poverty-everyone';

    const result = causeMap[key] || causeMap['default'];

    document.getElementById('resultCause').textContent       = result.cause;
    document.getElementById('resultDescription').textContent = result.description;
    document.getElementById('suggestedSkills').innerHTML     = result.skills.map(s => `<span class="skill-pill">${s}</span>`).join('');
    document.getElementById('traitList').innerHTML           = result.traits.map(t => `<div class="trait-item"><div class="trait-dot"></div>${t}</div>`).join('');

    document.getElementById('quizSection').style.display    = 'none';
    document.getElementById('resultsSection').style.display = 'block';
    fill.style.width = '100%';
    lucide.createIcons();

    try {
        if (currentUser) {
            await updateDoc(doc(db, 'users', currentUser.uid), {
                preferredCause: result.cause,
                quizCompleted:  true,
                quizAnswers:    { q1, q2, q3, q4 }
            });
        }
    } catch (err) { console.error('Save error:', err); }
});

window.retakeQuiz = () => {
    Object.keys(answers).forEach(k => delete answers[k]);
    current = 1;
    document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
    document.getElementById('quizSection').style.display    = 'block';
    document.getElementById('resultsSection').style.display = 'none';
    updateUI();
};

updateUI();
</script>
</body>
</html>
